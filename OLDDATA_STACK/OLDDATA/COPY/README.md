
# Прогнозирование биологических свойств химических соединений

## Цель проекта
Построить модели машинного обучения для оценки трёх ключевых свойств химических соединений:
- IC50 — эффективность вещества
- CC50 — токсичность вещества
- SI (Selectivity Index) — соотношение токсичности к эффективности (SI = CC50 / IC50)

Проект включает задачи как регрессии, так и бинарной классификации.

## Описание данных
- Размер выборки: 1001 соединение
- Признаков: 214 молекулярных дескриптора
- Целевые переменные: IC50, CC50, SI (в исходном и логарифмированном виде)

## Задачи проекта
### Регрессия:
- Предсказание log(IC50)
- Предсказание log(CC50)
- Предсказание log(SI)

### Классификация:
- IC50 > медианы
- CC50 > медианы
- SI > медианы
- SI > 8

## Этапы решения
1. Разведочный анализ (EDA)
   - Проверка корректности SI
   - Анализ выбросов и распределений
   - Построение boxplot и корреляционной матрицы

2. Feature Engineering
   - Логарифмирование целевых переменных: log(IC50), log(CC50), log(SI)
   - Добавление признаков: ratio_IC50_CC50, chi_ratio

3. Очистка данных
   - Удаление выбросов по IC50, CC50, SI
   - Удаление признаков с нулевой дисперсией
   - Импутация пропусков медианой
   - Масштабирование признаков

4. Обучение моделей
   - Классификация: CatBoostClassifier
   - Регрессия: RandomForestRegressor
   - Использована кросс-валидация (5 фолдов)
   - Проведён честный hold-out анализ

5. Визуализация
   - Boxplot, корреляционная матрица
   - PCA и UMAP по признакам
   - Графики mutual information
   - ROC-кривые и scatter-графики

6. Финальный анализ
   - Скрипт sanity_check.py: проверка финальных моделей на отложенной выборке
   - plot.py: генерация всех графиков и таблиц метрик

## Структура проекта
```
CML_Final/
├── data/
│   └── data_prepared.csv
├── models/
│   └── *.joblib (сохранённые модели, скейлеры, фичи)
├── plots/
│   └── *.png (графики, таблицы, кривые)
├── clf_ic50_median.py
├── clf_cc50_median.py
├── clf_si_median.py
├── clf_si_gt8.py
├── reg_ic50.py
├── reg_cc50.py
├── reg_si.py
├── sanity_check.py
├── plot.py
├── eda.py
├── README.md
└── report.docx / report.pdf
```

## Результаты

### Классификация

| Задача           | Accuracy | F1     | ROC AUC |
|------------------|----------|--------|---------|
| IC50 > median    | 0.9910   | 0.9909 | 0.9987  |
| CC50 > median    | 1.0000   | 1.0000 | 1.0000  |
| SI > median      | 0.9930   | 0.9930 | 0.9960  |
| SI > 8           | 1.0000   | 1.0000 | 1.0000  |

### Регрессия

| Задача       | MAE    | RMSE   | R²     |
|--------------|--------|--------|--------|
| log(IC50)    | 0.0497 | 0.1024 | 0.9970 |
| log(CC50)    | 0.0051 | 0.0237 | 0.9998 |
| log(SI)      | 0.0181 | 0.1799 | 0.9847 |

## Как воспроизвести
1. Подготовка среды:
```
pip install -r requirements.txt
```

2. Запуск sanity check:
```
python sanity_check.py
```

3. Генерация всех визуализаций:
```
python plot.py
```

## Вывод
Модели показывают высокое качество и стабильность. Весь процесс — от EDA до валидации — воспроизводим и задокументирован. Подход может быть использован для анализа новых соединений, в том числе в фармакологических целях.

